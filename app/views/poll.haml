%h2= @poll.title

- if @poll.serious
  .serious-info
    Dies ist eine
    = succeed '.' do
      %strong.serious Abstimmung.
    Sie endet am
    = succeed ',' do
      %strong.end_date= @poll.end_date.strftime("%d.%m.%y")
    nur der Ersteller kann Antwortmöglichkeiten hinzufügen, und es ist nicht möglich, seine Wahl zu ändern.

%table.answers-table
  %tbody
    - @poll.answers.each do |answer|
      %tr.answer
        %td.name
          = answer.name
          %br
          %span.creator
            von
            = answer.creator.name
        %td
          %span.votes= answer.vote_count
          %span.info= answer.vote_count == 1 ? 'Stimme' : 'Stimmen'
          
        %td
          - if !@poll.serious || (@poll.vote_for(current_user).new_record? && Date.today < @poll.end_date)
            %form.vote{ action: "/polls/#{@poll.id}/vote", method: 'post' }
              %input{ name: "vote[answer_id]", type: 'hidden', :value => answer.id }
              - if @poll.vote_for(current_user).answer == answer
                %input.choice{ type: 'submit', value: 'Dafür stimmst du!' }
              - else
                %input.alternative{ type: 'submit', value: 'Dafür stimmen' }
            
- if !@poll.serious || @poll.creator == current_user
  %h2 Neue Antwortmöglichkeit
  %form{ action: "/polls/#{@poll.id}/answers", method: 'post' }
    %p
      %input{ name: "answer[name]", type: 'text', :size => 60}
  
      %input{ type: 'submit', value: 'Speichern' }

%p
  %a{ :href => '/polls' } Zurück zu den anderen Umfragen

- section :footer do
  %p#last-edit 
    == Erstellt von
    %span.user_name= @poll.creator.name
    am
    = @poll.created_at.strftime("%d.%m.%y um %H:%M")